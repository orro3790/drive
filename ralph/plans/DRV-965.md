# Audit data table system

Task: DRV-965

## Steps

1. Build a file inventory for `src/lib/components/data-table/` (including `cells/`) and derive requirement IDs `R1..Rn` directly from the `DESCRIPTION` field in `bd show DRV-965` (the single source of truth), then map each requirement to target files/checks.
2. Define deterministic audit fixtures and expected outcomes before reviewing logic: `F_EMPTY` (0 rows), `F_SINGLE` (1 row), `F_MULTI` (21 rows, page size 10), `F_LARGE` (150 rows with null/undefined and mixed formats). Use these fixtures to run pass/fail checks for TanStack integration, sorting/filtering correctness, and pagination boundaries (first/last/empty/single-page).
3. Audit functional UX flows with explicit pass/fail criteria: combined filters (range + dropdown intersection), cell rendering/formatting (date/number/badge), null/undefined rendering safety, export behavior consistency with implemented table state, and empty-state messaging clarity.
4. Audit non-functional quality with explicit pass/fail criteria: responsive behavior at `390px` (no blocked interaction from overflow, usable column visibility), accessibility semantics (table roles, sortable state exposure such as `aria-sort`, keyboard-triggered sorting, sortable announcement behavior), and performance risks on `F_LARGE` (identify avoidable full-table re-renders/expensive recomputations with evidence).
5. Write `logs/nightly/2026-02-10/audit-components-data-table.md` using a fixed structure (Scope, Requirement Matrix, Fixtures & Method, Findings by severity, Evidence, Remediation, Coverage Appendix), with evidence as `file:path:line` and a full per-file coverage checklist.

## Acceptance Criteria

- Production-readiness audit covers all 17+ files in `src/lib/components/data-table/`, including `cells/`.
- Requirement matrix traces every check back to `bd show DRV-965` description bullets (single source of truth).
- Findings evaluate TanStack integration, pagination boundary conditions, and filter panel behavior using deterministic fixtures (`F_EMPTY`, `F_SINGLE`, `F_MULTI`, `F_LARGE`) with explicit pass/fail outcomes.
- Findings evaluate renderer formatting/null handling, export correctness, and empty-state behavior with concrete `file:path:line` evidence.
- Findings evaluate performance risks for 100+ row datasets, responsive behavior at `390px`, and accessibility (table ARIA roles/states, keyboard sorting, sortable announcements) with explicit pass/fail criteria.
- Report is written to `logs/nightly/2026-02-10/audit-components-data-table.md` with severity ratings (Critical/High/Medium/Low), actionable remediation, `file:path:line` evidence, and a per-file coverage checklist.
